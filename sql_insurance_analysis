create database insurance
use insurance
drop table insurance
create table insurance
(
age	varchar(40),
sex	varchar(10),
bmi	decimal(6,3),
children int,	
smoker varchar(10),
region	varchar(30),
charges decimal(12,5)
);

SET SESSION sql_mode = ''
LOAD DATA  INFILE 'C:/ProgramData/MySQL/MySQL Server 8.0/Uploads/insurance.csv'
INTO TABLE insurance
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 LINES
select * FROM INSURANCE

---------------------------------------------------------------------------------------------------------
SELECT COUNT(*) FROM INSURANCE-- 1338

SELECT SEX, COUNT(*) FROM INSURANCE -- FEM--662--MALE- 676
GROUP BY SEX

SELECT SEX,ROUND(AVG(BMI),2) FROM INSURANCE -- FEMALE 30.38, MALE 30.94
GROUP BY SEX

SELECT SEX, MAX(BMI),MIN(BMI) AS QWR FROM INSURANCE                       -- # SEX, MAX(BMI), QWR
GROUP BY SEX										                      -- 'female', '48.070', '16.815'
													                      -- 'male', '53.130', '15.960'GROUP BY SEX


SELECT COUNT(*) FROM INSURANCE WHERE AGE IS NULL
select * FROM INSURANCE
SELECT COUNT(*) FROM INSURANCE WHERE SEX IS NULL-- 0
SELECT COUNT(*) FROM INSURANCE WHERE bmi IS NULL -- 0
SELECT COUNT(*) FROM INSURANCE WHERE CHILDREN IS NULL -- 0
SELECT COUNT(*) FROM INSURANCE WHERE SMOKER IS NULL -- 0
SELECT COUNT(*) FROM INSURANCE WHERE region IS NULL -- 0
SELECT COUNT(*) FROM INSURANCE WHERE charges IS NULL -- 0

--  RELATION BETWEEN NO OF SMOKERS AND AVG CHANRGES AND BMI
SELECT REGION ,ROUND(AVG(BMI),2),ROUND(AVG(AGE),2), ROUND(AVG(CHARGES),2) , COUNT(*) AS NO_OF_SMOKER FROM INSURANCE
WHERE SMOKER = "yes" AND SEX= "male"
GROUP BY REGION
ORDER BY NO_OF_SMOKER DESC

SELECT REGION ,ROUND(AVG(BMI),2),ROUND(AVG(AGE),2), ROUND(AVG(CHARGES),2) , COUNT(*) AS NO_OF_SMOKER FROM INSURANCE
WHERE SMOKER = "yes" AND SEX= "female"
GROUP BY REGION
ORDER BY NO_OF_SMOKER DESC

SELECT SEX , COUNT(*) ,AVG(AGE), MAX(BMI),MIN(BMI) FROM INSURANCE 
WHERE ROUND(bmi,2) > 24.9 AND ROUND(bmi,2) < 18.5
GROUP BY SEX



SELECT COUNT(*) FROM INSURANCE WHERE SMOKER = "yes" -- 274 18.5 to 24.9
select * FROM INSURANCE


SELECT REGION,SUM(CHILDREN) FROM INSURANCE
GROUP BY REGION 
